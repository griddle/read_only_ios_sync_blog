supporting code for http://igarret.com/blog/?p=62
